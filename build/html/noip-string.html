<h2 id="hash" tabindex="-1">hash</h2>
<p>这里展示使用自然溢出的hash</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="dWxsJTIwaGFzaHMlNUJfJTVEJTJDYmFzZXMlNUJfJTVEJTJDYmFzZSUzRDEzMTMxMSUzQiUwQWJhc2VzJTVCMCU1RCUzRDElM0IlMEFmb3IoaW50JTIwaSUzRDElM0JpJTNDJTNEbiUzQmklMkIlMkIpJTdCJTBBJTA5YmFzZXMlNUJpJTVEJTNEYmFzZXMlNUJpLTElNUQqYmFzZSUzQiUwQSUwOWhhc2hzJTVCaSU1RCUzRGhhc2hzJTVCaS0xJTVEKmJhc2UlMkJzdHIlNUJpJTVEJTNCJTBBJTdEJTBBaW5saW5lJTIwdWxsJTIwcmFuZ2UoaW50JTIwbCUyQ2ludCUyMHIpJTdCcmV0dXJuJTIwaGFzaHMlNUJyJTVELWhhc2hzJTVCbC0xJTVEKmJhc2VzJTVCci1sJTJCMSU1RCUzQiU3RCUwQQ=="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></div><div class="code">ull hashs[_],bases[_],base=<span class="hljs-number">131311</span>;
bases[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++){
	bases[i]=bases[i<span class="hljs-number">-1</span>]*base;
	hashs[i]=hashs[i<span class="hljs-number">-1</span>]*base+str[i];
}
<span class="hljs-function"><span class="hljs-keyword">inline</span> ull <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r)</span></span>{<span class="hljs-keyword">return</span> hashs[r]-hashs[l<span class="hljs-number">-1</span>]*bases[r-l<span class="hljs-number">+1</span>];}
</div></code></pre>
<h3 id="qiu-zui-xiao-xun-huan-jie" tabindex="-1">求最小循环节</h3>
<p>首先线性筛预处理出素数
我们有下面两个性质</p>
<ul>
<li>若长度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 的前缀是 str 的循环节，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∗</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k*n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 也是 str 的循环节 （ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∗</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k*n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 都是字符串长度的因数）</li>
<li>若字符串从 1 到 (len-n) 的子字符串与从 (n+1) 到 len 的子字符串是相同的，且 n 为 len 的因数，则长度为 n 的前缀是该字符串的循环节
于是对于求给定区间的最小循环节，我们可以这样处理</li>
</ul>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="JTA5d2hpbGUocS0tKSU3QiUwQSUwOSUwOWludCUyMGwlMkNyJTNCY2luJTNFJTNFbCUzRSUzRXIlM0IlMEElMDklMDlpbnQlMjBsZW4lM0RyLWwlMkIxJTJDY250JTNEMCUzQiUwQSUwOSUwOXdoaWxlKGxlbiUzRTEpJTdCJTJGJTJGJUU4JUJGJTk5JUU0JUI4JTgwJUU2JUFEJUE1JUU2JTk4JUFGJUU1JTg4JTg2JUU4JUE3JUEzJUU4JUI0JUE4JUU1JTlCJUEwJUU2JTk1JUIwJTBBJTA5JTA5JTA5bnVtJTVCJTJCJTJCY250JTVEJTNEbnh0JTVCbGVuJTVEJTNCJTBBJTA5JTA5JTA5bGVuJTJGJTNEbnh0JTVCbGVuJTVEJTNCJTBBJTA5JTA5JTdEJTBBJTA5JTA5bGVuJTNEci1sJTJCMSUzQiUwQSUwOSUwOWZvcihpbnQlMjBpJTNEMSUzQmklM0MlM0RjbnQlM0JpJTJCJTJCKSU3QiUyRiUyRiVFNiVBMCVCOSVFNiU4RCVBRSVFNCVCOCU4QSVFOCVCRiVCMCVFNyVBQyVBQyVFNCVCOCU4MCVFNCVCOCVBQSVFNiU4MCVBNyVFOCVCNCVBOCVFRiVCQyU4QyVFNiU4OCU5MSVFNCVCQiVBQyVFNSVCMCU5RCVFOCVBRiU5NSVFNiU4QSU4QSVFNCVCOCU4MCVFNCVCOCVBQSVFOCVCNCVBOCVFNSU5QiVBMCVFNSVBRCU5MCVFOSU5OSVBNCVFNiU4RSU4OSVFNSU5MCU4RSVFOCVCRiU5OCVFNiU5OCVBRiVFNCVCOCU4RCVFNiU5OCVBRiVFNSVCRSVBQSVFNyU4RSVBRiVFOCU4QSU4MiUwQSUwOSUwOSUwOWludCUyMHRtcCUzRGxlbiUyRm51bSU1QmklNUQlM0IlMEElMDklMDklMDlpZihyYW5nZShsJTJDci10bXApJTNEJTNEcmFuZ2UobCUyQnRtcCUyQ3IpKSUyMGxlbiUzRHRtcCUzQiUyRiUyRiVFNiVBMCVCOSVFNiU4RCVBRSVFNCVCOCU4QSVFOCVCRiVCMCVFNyVBQyVBQyVFNCVCQSU4QyVFNCVCOCVBQSVFNiU4MCVBNyVFOCVCNCVBOCVFNSU4OCVBNCVFNiU5NiVBRCUwQSUwOSUwOSU3RCUwQSUwOSUwOWNvdXQlM0MlM0NsZW4lM0MlM0NlbmRsJTNCJTNCJTBBJTA5JTdEJTBB"><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div></div><div class="code">	<span class="hljs-keyword">while</span>(q--){
		<span class="hljs-type">int</span> l,r;cin&gt;&gt;l&gt;&gt;r;
		<span class="hljs-type">int</span> len=r-l<span class="hljs-number">+1</span>,cnt=<span class="hljs-number">0</span>;
		<span class="hljs-keyword">while</span>(len&gt;<span class="hljs-number">1</span>){<span class="hljs-comment">//这一步是分解质因数</span>
			num[++cnt]=nxt[len];
			len/=nxt[len];
		}
		len=r-l<span class="hljs-number">+1</span>;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=cnt;i++){<span class="hljs-comment">//根据上述第一个性质，我们尝试把一个质因子除掉后还是不是循环节</span>
			<span class="hljs-type">int</span> tmp=len/num[i];
			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">range</span>(l,r-tmp)==<span class="hljs-built_in">range</span>(l+tmp,r)) len=tmp;<span class="hljs-comment">//根据上述第二个性质判断</span>
		}
		cout&lt;&lt;len&lt;&lt;endl;;
	}
</div></code></pre>
<h3 id="qiu-zui-chang-gong-gong-qian-zhui" tabindex="-1">求最长公共前缀</h3>
<p><strong>【模板】后缀排序</strong>
读入一个长度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex"> n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 的由大小写英文字母或数字组成的字符串，请把这个字符串的所有非空后缀按字典序（用 ASCII 数值比较）从小到大排序，然后按顺序输出后缀的第一个字符在原串中的位置。位置编号为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex"> 1 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex"> n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>。
直接使用sort对每个字符串进行排序的时间复杂度其实是大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的，因为两个字符串之间的比较的复杂度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 的。为了快速比较两个字符串的字典序，我们考虑求出两个字符串的LCP，然后看LCP下一个字符哪个字符串的大
使用hash+二分来求</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="JTIzaW5jbHVkZSUzQ2JpdHMlMkZzdGRjJTJCJTJCLmglM0UlMEElMjNkZWZpbmUlMjBfJTIwMTAwMDAwNiUwQSUyM2RlZmluZSUyMHVsbCUyMHVuc2lnbmVkJTIwbG9uZyUyMGxvbmclMEF1c2luZyUyMG5hbWVzcGFjZSUyMHN0ZCUzQiUwQXVsbCUyMGJhc2UlM0QxMzEzMTElMkNoYXNocyU1Ql8lNUQlMkNiYXNlcyU1Ql8lNUQlM0IlMEFpbmxpbmUlMjB1bGwlMjByYW5nZShpbnQlMjBsJTJDaW50JTIwciklN0JyZXR1cm4lMjBsJTNDJTNEciUzRiUyMGhhc2hzJTVCciU1RC1oYXNocyU1QmwtMSU1RCpiYXNlcyU1QnItbCUyQjElNUQlM0EwJTNCJTdEJTBBY2hhciUyMHN0ciU1Ql8lNUQlM0IlMEFpbnQlMjBuJTJDYSU1Ql8lNUQlM0IlMEFpbmxpbmUlMjBib29sJTIwY21wKGludCUyMHglMkNpbnQlMjB5KSU3QiUwQSUwOWludCUyMGwlM0QwJTJDciUzRG1pbihuLXglMkIxJTJDbi15JTJCMSklMkNhbnMlM0QwJTNCJTJGJTJGciVFNSVBNCU4NCVFNyU5QSU4NCVFNiU4NCU4RiVFNiU4MCU5RCVFNiU5OCVBRiVFNSU4RiU5NiVFNCVCOCVBNCVFNCVCOCVBQSVFNSVBRCU5NyVFNyVBQyVBNiVFNCVCOCVCMiVFNCVCOSU4QiVFOSU5NyVCNCVFNyU5QSU4NCVFOSU5NSVCRiVFNSVCQSVBNiVFNiU5QyU4MCVFNSVCMCU4RiVFNyU5QSU4NCVFOSU4MiVBMyVFNCVCOCVBQSVFNSVBRCU5NyVFNyVBQyVBNiVFNCVCOCVCMiVFNyU5QSU4NCVFOSU5NSVCRiVFNSVCQSVBNiUwQSUwOXdoaWxlKGwlM0MlM0RyKSU3QiUwQSUwOSUwOWludCUyMG1pZCUzRChsJTJCciklM0UlM0UxJTNCJTBBJTA5JTA5aWYocmFuZ2UoeCUyQ3glMkJtaWQtMSklM0QlM0RyYW5nZSh5JTJDeSUyQm1pZC0xKSklMjBhbnMlM0RtaWQlMkNsJTNEbWlkJTJCMSUzQiUwQSUwOSUwOWVsc2UlMjByJTNEbWlkLTElM0IlMEElMDklN0QlMEElMDlpZihhbnMlM0QlM0RtaW4obi14JTJCMSUyQ24teSUyQjEpKSUyMHJldHVybiUyMHglM0V5JTNCJTBBJTA5ZWxzZSUyMHJldHVybiUyMHN0ciU1QnglMkJhbnMlNUQlM0NzdHIlNUJ5JTJCYW5zJTVEJTNCJTBBJTdEJTBBaW50JTIwbWFpbigpJTdCJTBBJTA5Y2luJTNFJTNFc3RyJTJCMSUzQiUwQSUwOW4lM0RzdHJsZW4oc3RyJTJCMSklM0IlMEElMDliYXNlcyU1QjAlNUQlM0QxJTNCJTBBJTA5Zm9yKGludCUyMGklM0QxJTNCaSUzQyUzRG4lM0JpJTJCJTJCKSU3QiUwQSUwOSUwOWJhc2VzJTVCaSU1RCUzRGJhc2VzJTVCaS0xJTVEKmJhc2UlM0IlMEElMDklMDloYXNocyU1QmklNUQlM0RoYXNocyU1QmktMSU1RCpiYXNlJTJCc3RyJTVCaSU1RCUzQiUwQSUwOSUwOWElNUJpJTVEJTNEaSUzQiUwQSUwOSU3RCUwQSUwOXNvcnQoYSUyQjElMkNhJTJCbiUyQjElMkNjbXApJTNCJTBBJTA5Zm9yKGludCUyMGklM0QxJTNCaSUzQyUzRG4lM0JpJTJCJTJCKSUyMGNvdXQlM0MlM0NhJTVCaSU1RCUzQyUzQyclMjAnJTNCJTBBJTA5cmV0dXJuJTIwMCUzQiUwQSU3RCUwQQ=="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div><div>28</div><div>29</div><div>30</div><div>31</div></div><div class="code"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> _ 1000006</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> ull unsigned long long</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
ull base=<span class="hljs-number">131311</span>,hashs[_],bases[_];
<span class="hljs-function"><span class="hljs-keyword">inline</span> ull <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r)</span></span>{<span class="hljs-keyword">return</span> l&lt;=r? hashs[r]-hashs[l<span class="hljs-number">-1</span>]*bases[r-l<span class="hljs-number">+1</span>]:<span class="hljs-number">0</span>;}
<span class="hljs-type">char</span> str[_];
<span class="hljs-type">int</span> n,a[_];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>{
	<span class="hljs-type">int</span> l=<span class="hljs-number">0</span>,r=<span class="hljs-built_in">min</span>(n-x<span class="hljs-number">+1</span>,n-y<span class="hljs-number">+1</span>),ans=<span class="hljs-number">0</span>;<span class="hljs-comment">//r处的意思是取两个字符串之间的长度最小的那个字符串的长度</span>
	<span class="hljs-keyword">while</span>(l&lt;=r){
		<span class="hljs-type">int</span> mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;
		<span class="hljs-keyword">if</span>(<span class="hljs-built_in">range</span>(x,x+mid<span class="hljs-number">-1</span>)==<span class="hljs-built_in">range</span>(y,y+mid<span class="hljs-number">-1</span>)) ans=mid,l=mid<span class="hljs-number">+1</span>;
		<span class="hljs-keyword">else</span> r=mid<span class="hljs-number">-1</span>;
	}
	<span class="hljs-keyword">if</span>(ans==<span class="hljs-built_in">min</span>(n-x<span class="hljs-number">+1</span>,n-y<span class="hljs-number">+1</span>)) <span class="hljs-keyword">return</span> x&gt;y;
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> str[x+ans]&lt;str[y+ans];
}
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
	cin&gt;&gt;str<span class="hljs-number">+1</span>;
	n=<span class="hljs-built_in">strlen</span>(str<span class="hljs-number">+1</span>);
	bases[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++){
		bases[i]=bases[i<span class="hljs-number">-1</span>]*base;
		hashs[i]=hashs[i<span class="hljs-number">-1</span>]*base+str[i];
		a[i]=i;
	}
	<span class="hljs-built_in">sort</span>(a<span class="hljs-number">+1</span>,a+n<span class="hljs-number">+1</span>,cmp);
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) cout&lt;&lt;a[i]&lt;&lt;<span class="hljs-string">&#x27; &#x27;</span>;
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</div></code></pre>
<h2 id="kmp" tabindex="-1">KMP</h2>
<p>处理nxt数组</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="aW50JTIwcCUzRDAlM0IlMEFueHQlNUIxJTVEJTNEMCUzQiUwQWZvcihpbnQlMjBpJTNEMSUzQmklM0NtJTNCaSUyQiUyQiklN0IlMEElMDl3aGlsZShwJTNFMCUyNiUyNmIlNUJpJTJCMSU1RCElM0RiJTVCcCUyQjElNUQpJTIwcCUzRG54dCU1QnAlNUQlM0IlMEElMDlpZihiJTVCaSUyQjElNUQlM0QlM0RiJTVCcCUyQjElNUQpJTIwcCUyQiUyQiUzQiUwQSUwOW54dCU1QmklMkIxJTVEJTNEcCUzQiUwQSU3RCUwQQ=="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></div><div class="code"><span class="hljs-type">int</span> p=<span class="hljs-number">0</span>;
nxt[<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;m;i++){
	<span class="hljs-keyword">while</span>(p&gt;<span class="hljs-number">0</span>&amp;&amp;b[i<span class="hljs-number">+1</span>]!=b[p<span class="hljs-number">+1</span>]) p=nxt[p];
	<span class="hljs-keyword">if</span>(b[i<span class="hljs-number">+1</span>]==b[p<span class="hljs-number">+1</span>]) p++;
	nxt[i<span class="hljs-number">+1</span>]=p;
}
</div></code></pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">nxt[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> 表示一直到位置i（包括i）的前缀字符串的最长公共前后缀长度<br>
并且，如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n \bmod (n-nxt[n])=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> 则该字符串是由前缀长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">n-nxt[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 的子串进行若干次拼接得到的
匹配</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="cCUzRDAlM0IlMEFmb3IoaW50JTIwaSUzRDAlM0JpJTNDbiUzQmklMkIlMkIpJTdCJTBBJTA5d2hpbGUocCUzRTAlMjYlMjZiJTVCcCUyQjElNUQhJTNEcyU1QmklMkIxJTVEKSUyMHAlM0RueHQlNUJwJTVEJTNCJTBBJTA5aWYoYiU1QnAlMkIxJTVEJTNEJTNEcyU1QmklMkIxJTVEKSUyMHAlMkIlMkIlM0IlMEElMDlpZihwJTNEJTNEbSklMjBhbnMlMkIlMkIlM0IlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></div><div class="code">p=<span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++){
	<span class="hljs-keyword">while</span>(p&gt;<span class="hljs-number">0</span>&amp;&amp;b[p<span class="hljs-number">+1</span>]!=s[i<span class="hljs-number">+1</span>]) p=nxt[p];
	<span class="hljs-keyword">if</span>(b[p<span class="hljs-number">+1</span>]==s[i<span class="hljs-number">+1</span>]) p++;
	<span class="hljs-keyword">if</span>(p==m) ans++;
}
</div></code></pre>
<h2 id="trie-shu" tabindex="-1">trie树</h2>
<h3 id="pu-tong-trie-shu" tabindex="-1">普通trie树</h3>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="c3RydWN0JTIwTm9kZSU3QmludCUyMHclMkNzb24lNUI2MiU1RCUzQiU3RCUyMHRyaWUlNUIzMDAwMDA2JTVEJTNCJTBBaW50JTIwc2l6ZSUzQiUwQWlubGluZSUyMHZvaWQlMjBwdXQoc3RyaW5nJTIwc3RyKSU3QiUwQSUwOWludCUyMHAlM0QwJTNCJTBBJTA5Zm9yKGludCUyMGklM0QwJTJDbm93JTNCaSUzQ3N0ci5zaXplKCklM0JpJTJCJTJCKSU3QiUwQSUwOSUwOWlmKCF0cmllJTVCcCU1RC5zb24lNUJub3clM0RzdHIlNUJpJTVELSdhJyU1RCklMjB0cmllJTVCcCU1RC5zb24lNUJub3clNUQlM0QlMkIlMkJzaXplJTNCJTBBJTA5JTA5cCUzRHRyaWUlNUJwJTVELnNvbiU1Qm5vdyU1RCUzQiUwQSUwOSUwOXRyaWUlNUJwJTVELnclMkIlMkIlM0IlMEElMDklN0QlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div></div><div class="code"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Node</span>{<span class="hljs-type">int</span> w,son[<span class="hljs-number">62</span>];} trie[<span class="hljs-number">3000006</span>];
<span class="hljs-type">int</span> size;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">put</span><span class="hljs-params">(string str)</span></span>{
	<span class="hljs-type">int</span> p=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>,now;i&lt;str.<span class="hljs-built_in">size</span>();i++){
		<span class="hljs-keyword">if</span>(!trie[p].son[now=str[i]-<span class="hljs-string">&#x27;a&#x27;</span>]) trie[p].son[now]=++size;
		p=trie[p].son[now];
		trie[p].w++;
	}
}
</div></code></pre>
<h3 id="01trie-zuo-ping-heng-shu" tabindex="-1">01trie作平衡树</h3>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">w[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> 用来kth，rak操作。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">num[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> 用来存放当前节点表示的数，省去了位运算的过程
有可能读入负数，需要先加上一个偏移量变成正数
加入操作</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="Y29uc3QlMjBpbnQlMjBvZmYlM0QxMDAwMDAwMCUzQiUwQWludCUyMHRyaWUlNUIxMDAwMDAwNyU1RCU1QjIlNUQlMkNudW0lNUIxMDAwMDAwNyU1RCUyQ3clNUIxMDAwMDAwNyU1RCUyQ3NpemUlM0QxJTNCJTBBaW5saW5lJTIwdm9pZCUyMGFkZChpbnQlMjB4JTJDaW50JTIwYyklN0IlMEElMDlpbnQlMjBwJTNEMSUzQiUwQSUwOXglMkIlM0RvZmYlM0IlMEElMDlmb3IoaW50JTIwaSUzRDMyJTJDbm93JTNCaSUzRSUzRDAlM0JpLS0pJTdCJTBBJTA5JTA5aWYoIXRyaWUlNUJwJTVEJTVCKG5vdyUzRCgoeCUzRSUzRWkpJTI2MSkpJTVEKSUyMHRyaWUlNUJwJTVEJTVCbm93JTVEJTNEJTJCJTJCc2l6ZSUzQiUwQSUwOSUwOXAlM0R0cmllJTVCcCU1RCU1Qm5vdyU1RCUzQiUwQSUwOSUwOXclNUJwJTVEJTJCJTNEYyUzQiUwQSUwOSU3RCUwQSUwOW51bSU1QnAlNUQlM0R4JTNCJTBBJTdEJTBB"><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div></div><div class="code"><span class="hljs-type">const</span> <span class="hljs-type">int</span> off=<span class="hljs-number">10000000</span>;
<span class="hljs-type">int</span> trie[<span class="hljs-number">10000007</span>][<span class="hljs-number">2</span>],num[<span class="hljs-number">10000007</span>],w[<span class="hljs-number">10000007</span>],size=<span class="hljs-number">1</span>;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> c)</span></span>{
	<span class="hljs-type">int</span> p=<span class="hljs-number">1</span>;
	x+=off;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">32</span>,now;i&gt;=<span class="hljs-number">0</span>;i--){
		<span class="hljs-keyword">if</span>(!trie[p][(now=((x&gt;&gt;i)&amp;<span class="hljs-number">1</span>))]) trie[p][now]=++size;
		p=trie[p][now];
		w[p]+=c;
	}
	num[p]=x;
}
</div></code></pre>
<p>rak操作。这个操作返回的是比给定的数小的个数。求排名还需要加一</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="aW5saW5lJTIwaW50JTIwcmFrKGludCUyMHgpJTdCJTBBJTA5aW50JTIwcCUzRDElMkNyZXMlM0QwJTNCJTBBJTA5eCUyQiUzRG9mZiUzQiUwQSUwOWZvcihpbnQlMjBpJTNEMzIlMkNub3clM0JpJTNFJTNEMCUzQmktLSklN0IlMEElMDklMDlpZihub3clM0QoKHglM0UlM0VpKSUyNjEpKSUyMHJlcyUyQiUzRHclNUJ0cmllJTVCcCU1RCU1QjAlNUQlNUQlM0IlMEElMDklMDlwJTNEdHJpZSU1QnAlNUQlNUJub3clNUQlM0IlMEElMDklN0QlMEElMDlyZXR1cm4lMjByZXMlM0IlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">rak</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>{
	<span class="hljs-type">int</span> p=<span class="hljs-number">1</span>,res=<span class="hljs-number">0</span>;
	x+=off;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">32</span>,now;i&gt;=<span class="hljs-number">0</span>;i--){
		<span class="hljs-keyword">if</span>(now=((x&gt;&gt;i)&amp;<span class="hljs-number">1</span>)) res+=w[trie[p][<span class="hljs-number">0</span>]];
		p=trie[p][now];
	}
	<span class="hljs-keyword">return</span> res;
}
</div></code></pre>
<p>kth操作</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="aW5saW5lJTIwaW50JTIwa3RoKGludCUyMGspJTdCJTBBJTA5aW50JTIwcCUzRDElM0IlMEElMDlmb3IoaW50JTIwaSUzRDMyJTJDbm93JTNCaSUzRSUzRDAlM0JpLS0pJTdCJTBBJTA5JTA5aWYodyU1QnRyaWUlNUJwJTVEJTVCMCU1RCU1RCUzQ2spJTIway0lM0R3JTVCdHJpZSU1QnAlNUQlNUIwJTVEJTVEJTJDcCUzRHRyaWUlNUJwJTVEJTVCMSU1RCUzQiUwQSUwOSUwOWVsc2UlMjBwJTNEdHJpZSU1QnAlNUQlNUIwJTVEJTNCJTBBJTA5JTdEJTBBJTA5cmV0dXJuJTIwbnVtJTVCcCU1RC1vZmYlM0IlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">kth</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span>{
	<span class="hljs-type">int</span> p=<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">32</span>,now;i&gt;=<span class="hljs-number">0</span>;i--){
		<span class="hljs-keyword">if</span>(w[trie[p][<span class="hljs-number">0</span>]]&lt;k) k-=w[trie[p][<span class="hljs-number">0</span>]],p=trie[p][<span class="hljs-number">1</span>];
		<span class="hljs-keyword">else</span> p=trie[p][<span class="hljs-number">0</span>];
	}
	<span class="hljs-keyword">return</span> num[p]-off;
}
</div></code></pre>
<p><strong>插入</strong> <code>add(x,1);</code>
<strong>删除</strong> <code>add(x,-1);</code>
<strong>求排名</strong> <code>cout&lt;&lt;rak(x)+1&lt;&lt;endl;</code>
<strong>求第x小</strong> <code>cout&lt;&lt;kth(x)&lt;&lt;endl;</code>
<strong>求前驱</strong> <code>cout&lt;&lt;kth(rak(x))&lt;&lt;endl;</code>
<strong>求后继</strong> <code>cout&lt;&lt;kth(rak(x+1)+1)&lt;&lt;endl;</code></p>
<h2 id="manacher" tabindex="-1">Manacher</h2>
<p>对字符串处理</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="JTA5c3RyJTVCMCU1RCUzRCd+JyUzQiUwQSUwOXN0ciU1QjElNUQlM0QnJTdDJyUzQiUwQSUwOWNudCUzRDElM0IlMEElMDljaGFyJTIwYyUzRGdldGNoYXIoKSUzQiUwQSUwOXdoaWxlKGMlM0MnYSclN0MlN0NjJTNFJ3onKSUyMGMlM0RnZXRjaGFyKCklM0IlMEElMDl3aGlsZShjJTNFJTNEJ2EnJTI2JTI2YyUzQyUzRCd6JyklMjBzdHIlNUIlMkIlMkJjbnQlNUQlM0RjJTJDc3RyJTVCJTJCJTJCY250JTVEJTNEJyU3QyclMkNjJTNEZ2V0Y2hhcigpJTNCJTBB"><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></div><div class="code">	str[<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;~&#x27;</span>;
	str[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;|&#x27;</span>;
	cnt=<span class="hljs-number">1</span>;
	<span class="hljs-type">char</span> c=<span class="hljs-built_in">getchar</span>();
	<span class="hljs-keyword">while</span>(c&lt;<span class="hljs-string">&#x27;a&#x27;</span>||c&gt;<span class="hljs-string">&#x27;z&#x27;</span>) c=<span class="hljs-built_in">getchar</span>();
	<span class="hljs-keyword">while</span>(c&gt;=<span class="hljs-string">&#x27;a&#x27;</span>&amp;&amp;c&lt;=<span class="hljs-string">&#x27;z&#x27;</span>) str[++cnt]=c,str[++cnt]=<span class="hljs-string">&#x27;|&#x27;</span>,c=<span class="hljs-built_in">getchar</span>();
</div></code></pre>
<p>求p数组</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="JTA5Zm9yKGludCUyMHQlM0QxJTJDciUzRDAlMkNtaWQlM0QwJTNCdCUzQyUzRGNudCUzQnQlMkIlMkIpJTdCJTBBJTA5JTA5aWYodCUzQyUzRHIpJTIwcCU1QnQlNUQlM0RtaW4ocCU1QihtaWQlM0MlM0MxKS10JTVEJTJDci10JTJCMSklM0IlMEElMDklMDl3aGlsZShzdHIlNUJ0LXAlNUJ0JTVEJTVEJTNEJTNEc3RyJTVCdCUyQnAlNUJ0JTVEJTVEKSUyMCUyQiUyQnAlNUJ0JTVEJTNCJTBBJTA5JTA5aWYocCU1QnQlNUQlMkJ0JTNFciklMjByJTNEcCU1QnQlNUQlMkJ0LTElMkNtaWQlM0R0JTNCJTBBJTA5JTdEJTBB"><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div></div><div class="code">	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> t=<span class="hljs-number">1</span>,r=<span class="hljs-number">0</span>,mid=<span class="hljs-number">0</span>;t&lt;=cnt;t++){
		<span class="hljs-keyword">if</span>(t&lt;=r) p[t]=<span class="hljs-built_in">min</span>(p[(mid&lt;&lt;<span class="hljs-number">1</span>)-t],r-t<span class="hljs-number">+1</span>);
		<span class="hljs-keyword">while</span>(str[t-p[t]]==str[t+p[t]]) ++p[t];
		<span class="hljs-keyword">if</span>(p[t]+t&gt;r) r=p[t]+t<span class="hljs-number">-1</span>,mid=t;
	}
</div></code></pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">[</mo><mi>t</mi><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p[t]-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">t</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 才是回文串长度</p>
