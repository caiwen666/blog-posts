<h2 id="gong-ping-zu-he-you-xi" tabindex="-1">公平组合游戏</h2>
<p>公平组合游戏（ICG）需要满足以下条件</p>
<ol>
<li>有两名玩家</li>
<li>两名玩家轮流操作，在一个有限集合内任选一个进行操作，改变游戏当前局面</li>
<li>一个局面的合法操作，只取决于游戏局面本身且固定存在，与玩家次序或者任何其它因素无关</li>
<li>无法操作者，即操作集合为空，输掉游戏，另一方获胜</li>
</ol>
<h2 id="sg-han-shu" tabindex="-1">SG函数</h2>
<p>对于一个ICG，我们定义一个函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sg(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> ,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>x</mi><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo>−</mo><mo>&gt;</mo><mi>y</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sg(x)=mex(\{ sg(y)|x-&gt;y \})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mopen">({</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">})</span></span></span></span> 即一个状态下的sg函数值为这个状态所能转移到的所有状态的sg，再取mex<br>
如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sg(x)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> 则状态x为必败态，反之为必胜态
对于多个ICG，我们有<strong>Sprague-Grundy定理</strong>：</p>
<blockquote>
<p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_1,x_2,...,x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为ICG的状态，则：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⊕</mo><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>⊕</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>⊕</mo><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sg(x_1+x_2+...+x_n)=sg(x_1) \oplus sg(x_2) \oplus ... \oplus sg(x_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
</blockquote>
<h2 id="chang-jian-bo-yi" tabindex="-1">常见博弈</h2>
<h3 id="nim" tabindex="-1">Nim</h3>
<p>即取石子游戏，有以下情况：</p>
<ol>
<li>可选步数为1~m的连续整数，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">sg(x)=x%(m+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></li>
<li>可选步数为任意步，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">sg(x)=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></li>
<li>可选步数为一系列不连续的数，采用打表，预处理sg数组</li>
</ol>
<h3 id="jie-ti-bo-yi" tabindex="-1">阶梯博弈</h3>
<p><div class="img-box"><img class="lazy" date-src="https://www.caiwen.work/wp-content/uploads/2022/08/0_1313488616cRqz.jpg" style="transform: scale(1)" width=560 height=282></div><br>
每次可以将阶梯上任意多个石子移到下一个阶梯上。无法再移动的一方为输<br>
把奇数编号的阶梯拿出来做Nim博弈即可<br>
注意有方向，即因为是把石子往前面一个阶梯上移动，所以从前向后进行编号。如果是往后面一个阶梯上移动，就要从后向前编号</p>
<h3 id="k-nim" tabindex="-1">k-Nim</h3>
<p>k-nim是Nim的变形，即每次可以从不超过k个堆中取出任意个石子，不能取的一方为输。<br>
首先我们把每个堆石子的数量表示为二进制，然后对所有的数逐位判断。如果有一位，所有的数这一位上为1的数量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">%</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\%(k+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">%</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>不为0，则先手必胜。反之先手必输</p>
<h3 id="anti-nim" tabindex="-1">anti-Nim</h3>
<p>和一般的Nim差不多，不过变成了把最后的石子取完的一方为输。我们有<strong>SJ定理</strong>：</p>
<blockquote>
<p>先手必胜，当且仅当：<br>
（1）单一游戏中有一个SG大于1，且整个游戏SG不为0<br>
（2）单一游戏中所有的SG小于等于1，且整个游戏SG为0</p>
</blockquote>
<h2 id="li-ti" tabindex="-1">例题</h2>
<p><a href="https://www.luogu.com.cn/problem/P2148#submit">P2148 [SDOI2009] E&amp;D</a><br>
首先打表找出sg函数的规律</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="aW50JTIwc2clNUIyMSU1RCU1QjIxJTVEJTJDdmlzJTVCMjElNUQlNUIyMSU1RCUzQiUwQWNvbnN0JTIwaW50JTIwbiUzRDIwJTNCJTBBaW50JTIwZGZzKGludCUyMHglMkNpbnQlMjB5KSU3QiUwQSUwOWlmKHZpcyU1QnglNUQlNUJ5JTVEJTdDJTdDdmlzJTVCeSU1RCU1QnglNUQpJTIwcmV0dXJuJTIwc2clNUJ4JTVEJTVCeSU1RCUzQiUwQSUwOWlmKHglM0QlM0QxJTI2JTI2eSUzRCUzRDEpJTIwcmV0dXJuJTIwMCUzQiUwQSUwOXZlY3RvciUzQ2ludCUzRSUyMHYlM0IlMEElMDklMkYlMkZjYXNlMSUwQSUwOWZvcihpbnQlMjBpJTNEMSUzQmklM0N4JTNCaSUyQiUyQiklN0IlMEElMDklMDl2LnB1c2hfYmFjayhkZnMoaSUyQ3gtaSkpJTNCJTBBJTA5JTdEJTBBJTA5JTJGJTJGY2FzZTIlMEElMDlmb3IoaW50JTIwaSUzRDElM0JpJTNDeSUzQmklMkIlMkIpJTdCJTBBJTA5JTA5di5wdXNoX2JhY2soZGZzKGklMkN5LWkpKSUzQiUwQSUwOSU3RCUwQSUwOXNvcnQodi5iZWdpbigpJTJDdi5lbmQoKSklM0IlMEElMDlpbnQlMjBwJTNEMCUzQiUwQSUwOWZvcihpbnQlMjBpJTNBdiklN0IlMEElMDklMDlpZihpJTNDcCklMjBjb250aW51ZSUzQiUwQSUwOSUwOWlmKGkhJTNEcCklN0IlMEElMDklMDklMDlicmVhayUzQiUwQSUwOSUwOSU3RCUwQSUwOSUwOXAlMkIlMkIlM0IlMEElMDklN0QlMEElMDl2aXMlNUJ4JTVEJTVCeSU1RCUzRHZpcyU1QnklNUQlNUJ4JTVEJTNEdHJ1ZSUzQiUwQSUwOXNnJTVCeCU1RCU1QnklNUQlM0RzZyU1QnklNUQlNUJ4JTVEJTNEcCUzQiUwQSUwOXJldHVybiUyMHAlM0IlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div></div><div class="code"><span class="hljs-type">int</span> sg[<span class="hljs-number">21</span>][<span class="hljs-number">21</span>],vis[<span class="hljs-number">21</span>][<span class="hljs-number">21</span>];
<span class="hljs-type">const</span> <span class="hljs-type">int</span> n=<span class="hljs-number">20</span>;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>{
	<span class="hljs-keyword">if</span>(vis[x][y]||vis[y][x]) <span class="hljs-keyword">return</span> sg[x][y];
	<span class="hljs-keyword">if</span>(x==<span class="hljs-number">1</span>&amp;&amp;y==<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
	vector&lt;<span class="hljs-type">int</span>&gt; v;
	<span class="hljs-comment">//case1</span>
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;x;i++){
		v.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">dfs</span>(i,x-i));
	}
	<span class="hljs-comment">//case2</span>
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;y;i++){
		v.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">dfs</span>(i,y-i));
	}
	<span class="hljs-built_in">sort</span>(v.<span class="hljs-built_in">begin</span>(),v.<span class="hljs-built_in">end</span>());
	<span class="hljs-type">int</span> p=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i:v){
		<span class="hljs-keyword">if</span>(i&lt;p) <span class="hljs-keyword">continue</span>;
		<span class="hljs-keyword">if</span>(i!=p){
			<span class="hljs-keyword">break</span>;
		}
		p++;
	}
	vis[x][y]=vis[y][x]=<span class="hljs-literal">true</span>;
	sg[x][y]=sg[y][x]=p;
	<span class="hljs-keyword">return</span> p;
}
</div></code></pre>
<p>得到下表
<div class="img-box"><img class="lazy" date-src="https://www.caiwen.work/wp-content/uploads/2022/08/v2-7cb5ba12b143387b381c6c2405c74657_r.png" style="transform: scale(1)" width=527 height=507></div>
找到规律
<div class="img-box"><img class="lazy" date-src="https://www.caiwen.work/wp-content/uploads/2022/08/v2-1ea2c34a3d82d87c16ccf2e89c33c6cb_720w.png" style="transform: scale(1)" width=527 height=507></div>
实现sg函数</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="aW50JTIwZ2V0U0coaW50JTIweCUyQ2ludCUyMHkpJTdCJTBBJTA5aWYoeCUyNTIlM0QlM0QxJTI2JTI2eSUyNTIlM0QlM0QxKSU3QiUwQSUwOSUwOXJldHVybiUyMDAlM0IlMEElMDklN0QlMEElMDlpZih5JTI1MiUzRCUzRDApJTIwc3dhcCh4JTJDeSklM0IlMEElMDlpZih5JTI1MiUzRCUzRDEpJTIweSUyQiUyQiUzQiUwQSUwOXJldHVybiUyMGdldFNHKHglMkYyJTJDeSUyRjIpJTJCMSUzQiUwQSU3RCUwQQ=="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div></div><div class="code"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getSG</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>{
	<span class="hljs-keyword">if</span>(x%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>&amp;&amp;y%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>){
		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
	}
	<span class="hljs-keyword">if</span>(y%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>) <span class="hljs-built_in">swap</span>(x,y);
	<span class="hljs-keyword">if</span>(y%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>) y++;
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">getSG</span>(x/<span class="hljs-number">2</span>,y/<span class="hljs-number">2</span>)<span class="hljs-number">+1</span>;
}
</div></code></pre>
<p>还可以检查一下</p>
<pre><div class="head"><div class="language">cpp</div><div class="copy" data="Zm9yKGludCUyMGklM0QxJTNCaSUzQyUzRG4lM0JpJTJCJTJCKSU3QiUwQSUwOWZvcihpbnQlMjBqJTNEMSUzQmolM0MlM0RuJTNCaiUyQiUyQiklN0IlMEElMDklMDlpZihnZXRTRyhpJTJDaiklM0QlM0RkZnMoaSUyQ2opKSU3QiUwQSUwOSUwOSUwOWNvdXQlM0MlM0MlMjJhY2NlcHQlMjIlM0MlM0NlbmRsJTNCJTBBJTA5JTA5JTdEZWxzZSU3QiUwQSUwOSUwOSUwOWNvdXQlM0MlM0MlMjJ3YSUyMiUzQyUzQ2VuZGwlM0IlMEElMDklMDklN0QlMEElMDklN0QlMEElN0QlMEE="><svg focusable="false" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></div></div><code class="hljs"><div class="lines"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div></div><div class="code"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++){
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;j++){
		<span class="hljs-keyword">if</span>(<span class="hljs-built_in">getSG</span>(i,j)==<span class="hljs-built_in">dfs</span>(i,j)){
			cout&lt;&lt;<span class="hljs-string">&quot;accept&quot;</span>&lt;&lt;endl;
		}<span class="hljs-keyword">else</span>{
			cout&lt;&lt;<span class="hljs-string">&quot;wa&quot;</span>&lt;&lt;endl;
		}
	}
}
</div></code></pre>
